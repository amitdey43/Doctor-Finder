<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SymptoCare</title>
    <link rel="stylesheet" href="/stylesheets/style1.css">
    <link rel="shortcut icon" href="/images/favicon.jpeg" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-blue-50 min-h-screen font-sans" style="display: flex;flex-direction: column;justify-content: start;">
        <header class="bg-white shadow-md px-4 sm:px-6 py-4 flex justify-around items-center flex-wrap" style="width:100%; height:70px;margin-bottom: 2rem;align-items: center;">
  
          <h1 class="text-2xl sm:text-3xl font-extrabold text-green-600 p-0"  id="symp"><a href="/user" style="border:1px solid black;border-radius: 50%;font-size: medium;padding: 5px;">ðŸ”™</a>  SymptoCare</h1>
            <span class="text-base sm:text-lg font-medium text-gray-800" id="ava">Available Doctors  
            </span>
        </header>
        <div class="p-3" id="avail" style=" max-width: 1000px;">
            <form action="/available" method="GET" class="flex gap-3 mb-4" id="formm" >
            <input type="text" name="search" id="search" placeholder="Search doctors by their name,address,Speciality..." class="flex-grow p-2 rounded border focus:outline-none bg-white" />
            <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Search</button>
            <button type="button" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700" id="doctor">All doctors</button>
            </form>

            <div class="mb-6">
            <p class="mb-2 text-lg font-medium text-gray-700">Select Category:</p>
            <div class="flex flex-wrap gap-2">
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">General Physician</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Cardiologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Dermatologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Pediatrician</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Orthopedic</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Neurologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">ENT Specialist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Gynecologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Psychiatrist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Dentist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">General Surgeon</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Sexologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Oncologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Hematologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Rheumatologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Nephrologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Urologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Gastroenterologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Pulmonologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Endocrinologist</button>
                <button type="button" class="search bg-blue-100 text-blue-800 px-4 py-2 rounded hover:bg-blue-200">Ophthalmologist</button>

            </div>
            </div>
        </div>
    <div class="p-3">
      
      <% doctors.forEach((doctor)=>{ %>
        <div class="bg-white rounded-lg shadow-md p-5 mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4" style="max-width: 600px;">
          
          
          <div class="flex items-center gap-4" id="left">
            <img src="<%= doctor.photo %>" class="w-16 h-16 rounded-full object-cover border" alt="Doctor" />
            <div>
              <h4 class="font-semibold text-lg">Dr. <%= doctor.name %></h4>
              <p class="text-sm text-gray-500"><b><%= doctor.specialities %></b></p>
              <p class="text-sm text-gray-500"><%= doctor.experience %> years experience</p>
              <p class="text-sm text-gray-500">Clinic: <%= doctor.clinic %></p>
            </div>
          </div>

          
          <div class="text-right md:text-left" id="right">
            <div class="flex flex-wrap items-center gap-2 text-sm text-gray-700 mb-2">
              <span class="font-medium">Available Days:</span>
              <%if(doctor.availabledays.length < 2){%>
                <strong>Currently unavailable</strong>
              <%}else{%>
                <% doctor.availabledays.forEach((day)=>{ %>
                  <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs"><%= day %></span>
                <% }) %>
              <%}%>
            </div>
            <b>Time slot: <%= doctor.starttime%> to <%= doctor.endtime%></b>
            <p class="text-blue-600 font-bold">$<%= doctor.fee %></p>
            <p class="text-sm text-gray-500 mb-2">per visit</p>

            <%
              let flag = false;
              appo.forEach((a) => {
                if (a.doctorid.toString() === doctor._id.toString()) {
                  flag = true;
                }
              });
            %>
            <% if(flag){ %>
              <div class="w-full">
                <button disabled class="w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition text-center">
                  âœ… Already Booked
                </button>
              </div>
            <% } else { %>
              <form action="/doctor/khela/<%= doctor.email %>" method="post" id="asolkhela" class="space-y-2 w-full">
                <input required type="datetime-local" name="datetime" class="border w-full p-2 rounded text-sm" />
                <button type="submit" class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition text-center">ðŸ“… Book Now</button>
              </form>
            <% } %>


          </div>
        </div>
      <% }) %>
    </div>
    <script>
        let button= document.querySelectorAll(".search");
        let input= document.querySelector("#search");
        let drbtn = document.querySelector("#doctor");
        let form = document.querySelector("#formm");

        drbtn.addEventListener("click",()=>{
          input.value="";
          form.submit();
        })
        button.forEach((b)=>{
            b.addEventListener("click",()=>{
                input.value= b.innerText;
            })
        })
    </script>
  
  
 
</body>
</html>
 
  <!-- <script>
    document.querySelector("#asolkhela").addEventListener("submit", async (e) => {
      e.preventDefault();
      console.log("Submit triggered");

      const formData = new FormData(form);
      const url = form.action;

      console.log("Sending data to:", url);
      
      try {
        const res = await fetch(url, {
          method: "POST",
          body: formData
        });

        const text = await res.text();
        console.log("Raw response text:", text);

        const data = JSON.parse(text); 

        if (data.success) {
          alert("Appointment booked successfully!");
        } else {
          alert("Error: " + data.message);
        }
      } catch (err) {
        console.error("Fetch error:", err);
        alert("Something went wrong");
      }
    });
  
</script> -->
